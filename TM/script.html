<script>
  var questionNum = '%s';
  var attempts = '%s';
  if (attempts > 3) {
    document.getElementById("attemptStr").innerHTML = "This is question " + questionNum + ", you have no attempts left";
    document.getElementById("submitBtn").disabled = true;
  } else {
    document.getElementById("attemptStr").innerHTML = "You are on question " + questionNum + " (attempt " + attempts + "/3) out of 10";
  }

  if (questionNum >= 10) {
    document.getElementById("nextBtn").disabled = true;
  } else if (questionNum <= 1) {
    document.getElementById("backBtn").disabled = true;
  }

  function nextQuestion() {

    fetch('/next', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      }
    })
      .then(response => {
        console.log('POST request sent successfully');
        location.reload();
      })
      .catch(error => {
        console.error('Error sending POST request:', error);
      });
  }

  function prevQuestion() {
    fetch('/back', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      }
    })
      .then(response => {
        console.log('POST request sent successfully');
        location.reload();
      })
      .catch(error => {
        console.error('Error sending POST request:', error);
      });
  }

  function submitAnswer() {
    
    // If the text area is on the DOM then replace data with the text area value
    //console.log(document.getElementById("text-input"));
    if (document.getElementById("text-input") != null) {
      data = document.getElementById("text-input").value;
    } else {
      let data = document.querySelector('input[name="answer"]:checked').value;
    }
    
    fetch('/submit', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    })

      .then(response => {
        console.log('POST request sent successfully');
        if (response.status == 200) {
          document.getElementById("submitBtn").disabled = true;
          document.getElementById("attemptStr").innerHTML = "This is question " + questionNum + ", you have no attempts left";
        } else {
          attempts = parseInt(attempts) + 1;
          if (parseInt(attempts) > 3) {
            document.getElementById("submitBtn").disabled = true;
            document.getElementById("attemptStr").innerHTML = "This is question " + questionNum + ", you have no attempts left";
          } else {
            document.getElementById("attemptStr").innerHTML = "You are on question " + questionNum + " (attempt " + attempts + "/3) out of 10";
          }
        }
        return response.json();
      })
      .then(data => {
        alert(data.message); // display the message in the alert
      })
      .catch(error => {
        console.error('Error sending POST request:', error);
      });
  }
</script>

</html>